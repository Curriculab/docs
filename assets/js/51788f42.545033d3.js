"use strict";(globalThis.webpackChunkcurriculab_docs=globalThis.webpackChunkcurriculab_docs||[]).push([[1916],{9088(e,r,t){t.r(r),t.d(r,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"decisions/grade-correction-audit-trail","title":"ADR-006: Grade on Enrollment with GradeCorrection as the Audit Trail","description":"Decision to store the current grade on Enrollment and use GradeCorrection as an immutable audit trail.","source":"@site/decisions/006-grade-correction-audit-trail.md","sourceDirName":"decisions","slug":"/decisions/grade-correction-audit-trail","permalink":"/docs/decisions/grade-correction-audit-trail","draft":false,"unlisted":false,"editUrl":"https://github.com/Curriculab/docs/edit/main/decisions/006-grade-correction-audit-trail.md","tags":[],"version":"current","lastUpdatedAt":1771560522000,"sidebarPosition":6,"frontMatter":{"sidebar_label":"ADR-006: Grade Correction Trail","description":"Decision to store the current grade on Enrollment and use GradeCorrection as an immutable audit trail."},"sidebar":"decisionsSidebar","previous":{"title":"ADR-005: Docusaurus","permalink":"/docs/decisions/docusaurus-documentation-platform"},"next":{"title":"ADR-007: Waitlist Position","permalink":"/docs/decisions/application-managed-waitlist-position"}}');var i=t(4848),s=t(8453);const o={sidebar_label:"ADR-006: Grade Correction Trail",description:"Decision to store the current grade on Enrollment and use GradeCorrection as an immutable audit trail."},a="ADR-006: Grade on Enrollment with GradeCorrection as the Audit Trail",d={},c=[{value:"Context",id:"context",level:2},{value:"Decision",id:"decision",level:2},{value:"Consequences",id:"consequences",level:2},{value:"Alternatives Considered",id:"alternatives-considered",level:2}];function l(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"adr-006-grade-on-enrollment-with-gradecorrection-as-the-audit-trail",children:"ADR-006: Grade on Enrollment with GradeCorrection as the Audit Trail"})}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Date:"})," 2026-02-19\n",(0,i.jsx)(r.strong,{children:"Status:"})," Accepted"]}),"\n",(0,i.jsx)(r.h2,{id:"context",children:"Context"}),"\n",(0,i.jsx)(r.p,{children:"Instructors submit grades for students at the end of a term. After submission, grades sometimes require correction \u2014 data entry errors, successful appeals, or administrative adjustments."}),"\n",(0,i.jsx)(r.p,{children:"Several constraints drive the design:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"FERPA"})," requires an auditable record of every grade change: what the grade was, what it became, who requested the change, who approved it, and when."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Transcript generation"})," must always reflect the current authoritative grade without reconstructing history."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Approval workflow"})," \u2014 grade corrections at many institutions require a second party (e.g., Registrar or Department Chair) to approve the change before it takes effect."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Immutability of the correction record"})," \u2014 once a grade correction is submitted, the record of that submission must not be editable, even if the correction itself is later rejected."]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"decision",children:"Decision"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"Enrollment.grade"})," holds the ",(0,i.jsx)(r.strong,{children:"current authoritative grade"})," at all times. It is the single value used for transcript generation, GPA calculation, and degree audits."]}),"\n",(0,i.jsxs)(r.p,{children:["Any post-submission change to a grade creates a new ",(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"GradeCorrection"})})," row recording ",(0,i.jsx)(r.code,{children:"old_grade"}),", ",(0,i.jsx)(r.code,{children:"new_grade"}),", ",(0,i.jsx)(r.code,{children:"reason"}),", ",(0,i.jsx)(r.code,{children:"submitted_by"}),", ",(0,i.jsx)(r.code,{children:"approved_by"}),", and ",(0,i.jsx)(r.code,{children:"status"})," (",(0,i.jsx)(r.code,{children:"pending"}),", ",(0,i.jsx)(r.code,{children:"approved"}),", ",(0,i.jsx)(r.code,{children:"rejected"}),"). The ",(0,i.jsx)(r.code,{children:"GradeCorrection"})," table is append-only \u2014 rows are never updated or deleted. When a correction is approved, the application updates ",(0,i.jsx)(r.code,{children:"Enrollment.grade"})," to the new value and sets ",(0,i.jsx)(r.code,{children:"GradeCorrection.approved_by"}),", ",(0,i.jsx)(r.code,{children:"approved_at"}),", and ",(0,i.jsx)(r.code,{children:"status = 'approved'"})," in the same transaction."]}),"\n",(0,i.jsx)(r.h2,{id:"consequences",children:"Consequences"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Positive"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["Transcript and GPA logic reads a single column (",(0,i.jsx)(r.code,{children:"Enrollment.grade"}),") \u2014 no history reconstruction needed at read time."]}),"\n",(0,i.jsx)(r.li,{children:"Full FERPA-compliant audit trail: every grade change is documented with the original value, replacement value, justification, submitter, approver, and timestamps."}),"\n",(0,i.jsxs)(r.li,{children:["The approval workflow is modelled as data (",(0,i.jsx)(r.code,{children:"status"}),", ",(0,i.jsx)(r.code,{children:"approved_by"}),", ",(0,i.jsx)(r.code,{children:"approved_at"}),") rather than process state held only in the application \u2014 the record survives restarts and is queryable."]}),"\n",(0,i.jsxs)(r.li,{children:["Multiple corrections on the same enrollment are supported naturally; each produces an independent ",(0,i.jsx)(r.code,{children:"GradeCorrection"})," row."]}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Negative"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["Displaying a student's full grade history requires a JOIN to ",(0,i.jsx)(r.code,{children:"GradeCorrection"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:["The update to ",(0,i.jsx)(r.code,{children:"Enrollment.grade"})," and the creation of the ",(0,i.jsx)(r.code,{children:"GradeCorrection"})," approval record must occur in a single transaction; the application must enforce this atomicity."]}),"\n",(0,i.jsxs)(r.li,{children:["A rejected correction does not update ",(0,i.jsx)(r.code,{children:"Enrollment.grade"}),', so the application must distinguish between "the grade was corrected" (approved) and "a correction was requested but denied" (rejected) when querying history.']}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Neutral"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["The initial grade submission (instructor posting grades for the first time) is not a correction \u2014 it is a direct write to ",(0,i.jsx)(r.code,{children:"Enrollment.grade"}),". ",(0,i.jsx)(r.code,{children:"GradeCorrection"})," is only created for subsequent changes."]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"alternatives-considered",children:"Alternatives Considered"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Event sourcing \u2014 grade as an event stream"}),"\nThe current grade is reconstructed by replaying a stream of grade events. Correct and auditable, but significantly more complex to implement and query. Transcript generation requires replaying the stream to find the terminal value. Rejected as over-engineering for a use case where a simple mutable column plus an audit table is sufficient."]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"GradeHistory table with no writeable grade on Enrollment"}),"\nThe current grade is always the most recent history row. Transcript generation requires ",(0,i.jsx)(r.code,{children:"SELECT ... ORDER BY created_at DESC LIMIT 1"}),". Slightly more complex reads than a direct column; adds latency and complexity to the highest-frequency query path. Rejected in favour of storing the current value explicitly."]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Mutable Enrollment row with no audit trail"}),"\nUpdate ",(0,i.jsx)(r.code,{children:"Enrollment.grade"})," in place; no history kept. Simple to implement but violates FERPA: there is no record of who changed a grade or what it was before the change. Rejected."]})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453(e,r,t){t.d(r,{R:()=>o,x:()=>a});var n=t(6540);const i={},s=n.createContext(i);function o(e){const r=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);